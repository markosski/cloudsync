Thing to consider:
- maintain list of files that need to be pushed, in case of crash list would be used to recover state.
- calculate checksum and store in on s3 in meta file